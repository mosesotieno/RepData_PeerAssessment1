---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) # set global chunk option
```


```{r libraries, message=FALSE}
library(tidyverse)      # Tidyverse for data manipulation
library(lubridate)     # Working with dates
library(knitr)        # Kniting
library(kableExtra)   # Printing nice tables
library(magrittr)     # 
```




## Loading and preprocessing the data

```{r loadpreprocessdata, include=FALSE}

#-- Load the data
activity <- read_csv("./data/activity.csv")

```


```{r processdata, echo=F, fig.height=4, fig.width=5}
#-- Have a look at raw data

print(activity, n =10)
View(activity)
glimpse(activity)   
dim(activity)
sample_n(activity, size = 10)

#-- Summary of the dataset
summary(activity)

#-- Missing values per variable 
sapply(activity, function(x) sum(is.na(x)))

#-- Simple plots for visualizations 

ggplot(activity, aes(steps)) + geom_histogram() + theme_bw()
  

```



## What is mean total number of steps taken per day?


```{r histogram1, message=FALSE, fig.height=4, fig.width=5}
#-- Histogram of total number of steps taken each day
activity <- activity %>% 
  group_by(date) %>% 
  mutate(total_steps = sum(steps))

plot1 <- ggplot(activity, aes(total_steps)) + geom_histogram() + theme_bw()
plot1 + ggtitle("Histogram of the total number of steps each day") + xlab("Total number of steps") + ylab("Count")
plot1
```


```{r median_steps, message=FALSE}
#--- Mean and median number of steps taken each day
activity %>% 
  group_by(date) %>% 
  summarise(
    mean_steps = mean(steps),
    median_steps = median(steps)
  ) %>% 
  kable() %>% 
  kable_styling() %>% 
  scroll_box(width = "500px", height = "500px")
 

```


## What is the average daily activity pattern?



## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
